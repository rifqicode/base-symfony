{% extends 'layout.html.twig' %}

{% block stylesheets %}{% apply spaceless %}
  <style media="screen">

    /* style only for this page */

    .info-box-content {
      padding: 12px 10px;
      margin-left: 110px;
    }

    .info-box-icon {
      background: white;
    }

    hr {
      margin-top: 20px;
      margin-bottom: 1px;
      border: 5;
      border-top: 1px solid #232121;
    }

    i.round {
      display: inline-block;
      border-radius: 60px;
      box-shadow: 0px 0px 2px #888;
      padding: 0.5em 0.6em;
    }

    #indonesia-map {
      height: 100%;
    }
  </style>
{% endapply %}{% endblock %}

{% block title %}{% apply spaceless %}{{ title | upper }}{% endapply %}{% endblock %}

{% block page_title %}{% apply spaceless %}{{ title }}{% endapply %}{% endblock %}

{% block content %}{% apply spaceless %}

        <div class="row">
          <div class="col-md-3 col-sm-6 col-xs-12">
            <div class="info-box">
              <span class="info-box-icon"><i class="fa fa-line-chart round bg-aqua"></i></span>

              <div class="info-box-content">
                <h3> Rp. 3.5 M <span> <i class="fa fa-download"></i> </span> </h3>
              </div>
              <hr>
            </div>
            <div class="col-md-12 text-center nopadding bg-aqua">
              <h4><b> Anggaran </b></h4>
            </div>
          </div>

          <div class="col-md-3 col-sm-6 col-xs-12">
            <div class="info-box">
              <span class="info-box-icon"><i class="fa fa-pie-chart round bg-green"></i></span>

              <div class="info-box-content">
                <h3> Rp. 1.2 M <span> <i class="fa fa-download"></i> </span> </h3>
              </div>
              <hr>
            </div>
            <div class="col-md-12 text-center nopadding bg-green">
              <h4><b> Realisasi </b></h4>
            </div>
          </div>


          <div class="col-md-3 col-sm-6 col-xs-12">
            <div class="info-box">
              <span class="info-box-icon"><i class="fa fa-tasks round bg-red"></i></span>

              <div class="info-box-content">
                <h3> Rp. 200 <span> <i class="fa fa-download"></i> </span> </h3>
              </div>
              <hr>
            </div>
            <div class="col-md-12 text-center nopadding bg-red">
              <h4><b> Jumlah Kegiatan </b></h4>
            </div>
          </div>

          <div class="col-md-3 col-sm-6 col-xs-12">
            <div class="info-box">
              <span class="info-box-icon"><i class="fa fa-area-chart round bg-yellow"></i></span>

              <div class="info-box-content">
                <h3> Rp. 20 <span> <i class="fa fa-download"></i> </span> </h3>
              </div>
              <hr>
            </div>
            <div class="col-md-12 text-center nopadding bg-yellow">
              <h4><b> Realisasi Kegiatan </b></h4>
            </div>
          </div>

        </div>

        <div class="row">
          <br>
          <div class="col-md-8 nopadding">
            <div class="box box-success">

              <div class="box-header with-border">
                <h3 class="box-title">PETA PROGRAM PER LOKASI</h3>

                <div class="box-tools pull-right">
                  <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                </div>
              </div>

              <div class="box-body">
                <div class="col-md-12">
                  <div id="indonesia-map" style="height:500px;"></div>
                </div>
                <div class="col-md-12">
                  <table class="table table-stripper">
                    <thead style="background: #8fb7e8;">
                      <th> No </th>
                      <th> Program </th>
                      <th> Jumlah Kegiatan </th>
                      <th> Penerima Manfaat </th>
                      <th> Jumlah Anggaran </th>
                    </thead>
                    <tbody>
                      <tr>
                        <td> 1 </td>
                        <td>
                          <a href="{{ path('activity_detail' , {activity : 'Dukungan Nakes'}) }}"> Dukungan Nakes </a>
                        </td>
                        <td> 10 </td>
                        <td> 500 </td>
                        <td> Rp. 2.500.000.000 </td>
                      </tr>
                      <tr>
                        <td> 2 </td>
                        <td>
                          <a href="{{ path('activity_detail' , {activity : 'Pemberian Sembako'}) }}"> Pemberian Sembako </a>
                        </td>
                        <td> 50 </td>
                        <td> 1000 </td>
                        <td> Rp. 500.000.000 </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

            </div>
          </div>

          <div class="col-md-4 nopadding">
            <div class="box box-warning">

              <div class="box-header with-border">
                <h3 class="box-title">GRAFIK KEGIATAN PER PROGRAM</h3>

                <div class="box-tools pull-right">
                  <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                </div>
              </div>

              <div class="box-body">
                <div class="col-md-12">
                  <div id="grafik-program"></div>
                </div>
              </div>

            </div>
          </div>
        </div>

        <div class="col-md-12">
          <div class="row">
            <br>
            <div class="box box-success">
                <div id="realisasi-satker"></div>
            </div>
          </div>
        </div>

        <div class="col-md-12">

          <div class="row">
            <br>
            <div class="box box-danger">
                <br>
                <table class="table table-stripper">
                  <thead style="background: #8fb7e8;">
                    <th> No </th>
                    <th> Program </th>
                    <th> Jumlah Kegiatan </th>
                    <th> Penerima Manfaat </th>
                    <th> Jumlah Anggaran </th>
                  </thead>
                  <tbody>
                    <tr>
                      <td> 1 </td>
                      <td> Pemberian APD kepada rumah sakit </td>
                      <td> 1000 </td>
                      <td> 500 </td>
                      <td> Rp. 1.500.000.000 </td>
                    </tr>
                    <tr>
                      <td> 2 </td>
                      <td> Pemberian Sembako kepada industri pariwisata </td>
                      <td> 500 </td>
                      <td> 200 </td>
                      <td> Rp. 500.000.000 </td>
                    </tr>
                  </tbody>
                </table>
            </div>
          </div>
        </div>


{% endapply %}{% endblock %}

{% block javascripts %}{% apply spaceless %}
  <script src="https://code.highcharts.com/maps/highmaps.js"></script>
  <script src="https://code.highcharts.com/maps/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/mapdata/countries/id/id-all.js"></script>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDTKAqOUCvrFh-iEKzfq0wHLlaso78iTgc&callback=initMap"></script>

  <script>

      function initMap() {
        var infoWindow = new google.maps.InfoWindow;

        function clickEvent(event) {
           // show kabkota here
        }

        function mouseoverEvent(event) {
          infoWindow.setContent(`Daerah : ${this.content} <br> Kode : ${this.code}`);
          infoWindow.setPosition(event.latLng);
          infoWindow.open(map);
        }


        var map = new google.maps.Map(document.getElementById('indonesia-map'), {
          zoom: 5,
          center: {lat: -0.789275, lng: 113.9213257},
          mapTypeId: 'roadmap'
        });

        var polygon = JSON.parse('{{ provinces | escape('js') }}');
        var triangleCoords = [];

        $.each(polygon, function( k , v ) {
          var polygon_row = v.polygon.split('\n'),
              drawPolygon = [];

          $.each(polygon_row , function( k , v2 ) {
            var split = v2.split(',');

            drawPolygon.push({
              lat: parseFloat(split[1]),
              lng: parseFloat(split[0])
            })
          });

          // draw polygon.
          var createPolygon = new google.maps.Polygon({
            content: v.name,
            code : v.code,
            paths: drawPolygon,
            strokeColor: '#FF0000',
            strokeOpacity: 0.8,
            strokeWeight: 2,
            fillColor: '#FF0000',
            fillOpacity: 0.35
          });
          createPolygon.setMap(map);
          createPolygon.addListener('click' , clickEvent);
          createPolygon.addListener('mouseover' , mouseoverEvent);
        });
      }

      $(document).ready(function() {

        let grafik = Highcharts.chart('grafik-program', {
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
            credits: {
              enabled: false
            },
            title: {
                text: ''
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            exporting: { enabled: false },
            accessibility: {
                point: {
                    valueSuffix: '%'
                }
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    size: 200,
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b>: {point.percentage:.1f} %'
                    }
                }
            },
            series: [{
                name: 'Kemenparekraf',
                colorByPoint: true,
                data: [{
                    name: 'Dukungan Nakes',
                    y: 61.41,
                    sliced: true,
                    selected: true
                }, {
                    name: 'Pemberian Sembako',
                    y: 11.84
                }, {
                    name: 'Revitalisasi',
                    y: 10.85
                }]
            }]
        });

        let realisasi_satker = Highcharts.chart('realisasi-satker', {
            chart: {
                type: 'column'
            },
            credits: {
              enabled: false
            },
            exporting: { enabled: false },
            title: {
                text: 'GRAFIK KEGIATAN PER ESELON I'
            },
            xAxis: {
                categories: [
                    'INSPEKTUR UTAMA',
                    'SEKRETARIS KEMENTERIAN',
                    'DEPUTI BIDANG KEBIJAKAN STRATEGIS',
                    'DEPUTI BIDANG SUMBERDAYA DAN KELEMBAGAAN',
                    'DEPUTI BIDANG SUMBERDAYA DAN KELEMBAGAAN',
                    'DEPUTI BIDANG PENGEMBANGAN DESTINASI DAN INFRASTRUKTUR',
                    'DEPUTI BIDANG INDUSTRIDAN INVESTASI',
                    'DEPUTI BIDANG PEMASARAN',
                    'DEPUTI BIDANG PRODUKWISATA DAN PENYELENGGARA KEGIATAN',
                    'DEPUTI BIDANG EKONOMI DIGITAL DAN PRODUK KREATIF',
                ],
                crosshair: true
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Rainfall (mm)'
                }
            },
            tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0,
                    point: {
                        events:{
                            click: function(e) {
                                var go = Routing.generate('dashboard_satker', {name : this.category})
                                window.open(go , '_blank');
                            }
                        }
                    }
                },
            },
            series: [{
                name: 'Anggaran',
                data: [49.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1]

            }, {
                name: 'Realisasi',
                data: [83.6, 78.8, 98.5, 93.4, 106.0, 84.5, 105.0, 104.3, 91.2, 83.5]
            }
          ]
        });
      });
  </script>
{% endapply %}{% endblock %}
